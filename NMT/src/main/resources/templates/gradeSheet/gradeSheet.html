<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NONMENTOR</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <link th:href="@{/css/header.css}" rel="stylesheet" />
  <link th:href="@{/css/footer.css}" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
          crossorigin="anonymous"></script>
  <style>
    .special-font{
      font-weight: 900; font-size: larger; color: #0076C0;
    }

    p { margin: 0px 0px 0px 0px;}
    .wrap_detail_info table{
      width: 100%;
    }
    .wrap_detail_info table td{
      padding: 6px 0px 6px 0px;
    }

  </style>
</head>

<body>
<!--페이지 최상위 헤더-->
<div th:replace='template/header :: header'>
</div>

<div class="container" style="margin-left: auto; margin-right: auto; padding-bottom: 20px;">
  <!-- 문제 제목 -->
  <div style="margin : 20px; display:flex; margin-bottom: 5px; margin-left: 1%;">
    <h2 th:text="${gradeSheet.probTitle}">
      고려대학교 22/인문
    </h2>
  </div>
  <div style="height: 3px; margin : 5px 15px 5px 1%; background-color: gray;">
  </div>

  <!-- 작성자 프로필-->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      작성자
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <div style="margin-left : 1%;" th:text="${gradeSheet.userNickName}">
    이름
  </div>

  <!-- 작성 답안-->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      작성 답안
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <div style="margin-left : 1%;">
    <div style="width: 100%; background-color: #d9d9d9; border: 1px solid white;">

      <div style="margin : 2% 2% 2% 2%" th:text="${gradeSheet.text}">
      </div>
    </div>
  </div>

  <!-- 성적 차트 제목-->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      성적
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <!-- 성적 차트 블럭-->
  <div style="display: flex;">
    <div style="margin: auto;">
      <div style="width: 30vw">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
        <canvas id="radar-chart"></canvas>
      </div>
      <div style="text-align: center;">
        <span class="special-font" th:text="${gradeSheet.userNickName}">황태호</span>
        님의 상세 성적표
      </div>
    </div>
    <div style="margin:auto">
      <div style="width: 30vw;">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>
        <canvas id="bar-chart" width="300" height="230"></canvas>
      </div>
      <div style="text-align: center; border-bottom: 1px solid #0076C0; width: 30%; margin: auto;">
        <span>성적 </span>
        <span class="special-font" th:text="${gradeSheet.grade}"> B </span>
      </div>
      <div style="text-align: center">
        <span class="special-font" th:text="${gradeSheet.userNickName}">황태호</span>
        님의 성적은
        <span class="special-font">상위</span>
        <span class="special-font" id="percentage">21</span>
        <span class="special-font">%</span>입니다.
      </div>
    </div>
  </div>

  <!-- 성적 상세 분석 제목 -->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      상세 분석
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <!-- 상세 분석 표-->
  <div style="margin-left: 1%;">
    <div class="wrap_detail_info">
      <table style="text-align: center;">
        <colgroup>
          <col width="98">
          <col width="92">
          <col width="86">
          <col width="380">
        </colgroup>
        <thead style="border-top: solid 2px black; text-align: center;
                    border-bottom: solid 1px #eaeaea;">
        <tr>
          <th scope="col" style="padding: 10px; width: 10%;">항목</th>
          <th scope="col" style="padding: 10px; width: 10%;">성적</th>
          <th scope="col" style="padding: 10px; width: 10%;">등급</th>
          <th scope="col" style="padding: 10px;">설명</th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td class="tit">총점</td>
          <td class="rating">
            <span id="total-value" th:text="${gradeSheet.grade1}">A</span>
          </td>
          <td class="per" id="total-grade">100%</td>
          <td class="text" style="text-align:left">
            <p>여러가지 세부항목과 전체적인 글의 완성도를 종합해서 평가합니다.</p>
          </td>
        </tr>
        <tr style="background-color: #eaeaea;">
          <td class="tit">독해력</td>
          <td class="rating">
            <span id="reading-value" th:text="${gradeSheet.grade2}">A</span>
          </td>
          <td class="per" id="reading-grade">96%</td>
          <td class="text" style="text-align:left">
            <p>제시문을 정확히 이해하고 정확히 제시한 대로 이행했는지 여부를 평가합니다.</p>
          </td>
        </tr>
        <tr>
          <td class="tit">논리력</td>
          <td class="rating">
            <span id="logical-value" th:text="${gradeSheet.grade3}">B</span>
          </td>
          <td class="per" id="logical-grade">91%</td>
          <td class="text" style="text-align:left">
            <p>일관된 논리의 흐름대로 논리를 전개하고 설득력있는 글을 적었는지 여부를 평가합니다.
            </p>
          </td>
        </tr>
        <tr style="background-color: #eaeaea;">
          <td class="tit">표현력</td>
          <td class="rating">
            <span id="implement-value" th:text="${gradeSheet.grade4}">D</span>
          </td>
          <td class="per" id="implement-grade">55%</td>
          <td class="text" style="text-align:left">
            <p>논리적인 글쓰기를 위한 다양한 어휘와 맞춤법에 알맞는 표현을 썼는지 여부를 평가합니다.</p>
          </td>
        </tr>
        <tr>
          <td class="tit">모범답안 유사도</td>
          <td class="rating">
            <span id="similarity-value" th:text="${gradeSheet.grade5}">D</span>
          </td>
          <td class="per" id="similarity">B</td>
          <td class="text" style="text-align:left">
            <p>모범답안과 비교해서, 사용자의 답안이 얼마나 비슷한 흐름과 내용을 가졌는지 유사도 정도를 평가합니다.</p>
          </td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- 대학 측 공식 해설 -->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      논제 해설
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <!-- 공식 해설 내용 -->
  <div style="margin-left : 1%;">
    <div style="width: 100%; background-color: #d9d9d9; border: 1px solid white;">
      <div style="margin : 2% 2% 2% 2%" th:utext="${gradeSheet.probExp}">

      </div>
    </div>
  </div>

  <!-- 대학 측 예시 답안 -->
  <div style="margin: 20px; margin-top: 40px;margin-left: 1%;">
    <h4>
      대학 측 예시 답안
    </h4>
    <div style="height: 3px; width: 70px;margin : 5px 0px 5px 0px; background-color: #0076C0;">
    </div>
  </div>
  <!-- 예시 답안 내용 -->
  <div style="margin-left : 1%;">
    <div style="width: 100%; background-color: #d9d9d9; border: 1px solid white;">

      <div style="margin : 2% 2% 2% 2%" th:insert='${gradeSheet.bestText} :: bestText'>
      </div>
    </div>
  </div>

  <!-- 돌아가기 버튼 -->
  <a th:href="@{/problem(problemId=${gradeSheet.problemId})}" style="">
  <div id = "backward-btn"style="width: 10%; margin-left: 90%; margin-top: 50px; border-radius: 3px;
        background-color: #0076C0; color: white; text-align: center; padding: 5px;">
    돌아가기
  </div>
  </a>

</div>
<!-- footer 작성 -->
<div th:replace='template/footer :: footer'>
</div>


<!-- Option 1: Bootstrap Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
</body>

<script th:inline="javascript">


  const $backward_btn = document.getElementById('backward-btn');
  let $total_grade=document.getElementById('total-grade');
  let $reading_grade=document.getElementById('reading-grade');
  let $logic_grade=document.getElementById('logical-grade');
  let $impl_grade=document.getElementById('implement-grade');
  let $similarity=document.getElementById('similarity');

  let $total_value=document.getElementById('total-value');
  let $reading_value=document.getElementById('reading-value');
  let $logic_value=document.getElementById('logical-value');
  let $impl_value=document.getElementById('implement-value');
  let $similarity_value=document.getElementById('similarity-value');
  let $percentage=document.getElementById('percentage');

  let grade1=[[${gradeSheet.grade1}]];
  let grade2=[[${gradeSheet.grade2}]];
  let grade3=[[${gradeSheet.grade3}]];
  let grade4=[[${gradeSheet.grade4}]];
  let grade5=[[${gradeSheet.grade5}]];
  let userNickname=[[${gradeSheet.userNickName}]];
  let probTitle=[[${gradeSheet.probTitle}]];

  $backward_btn.addEventListener('click',function(){
    window.location.href="main.html";
  });

  $total_value.innerText=grade1.toFixed(2);
  $reading_value.innerText=grade2.toFixed(2);
  $logic_value.innerText=grade3.toFixed(2);
  $impl_value.innerText=grade4.toFixed(2);
  $similarity_value.innerText=grade5+"%";
  $percentage.innerText=(100-grade1*33);

  if(grade1>=2.5){
    $total_grade.innerText='A';
  }else if(grade1>=2){
    $total_grade.innerText='B';
  }else if(grade1>=1){
    $total_grade.innerText='C';
  }else{
    $total_grade.innerText='D';
  }
  if(grade2>=3){
    $reading_grade.innerText='A';
  }else if(grade2>=2){
    $reading_grade.innerText='B';
  }else if(grade2>=1){
    $reading_grade.innerText='C';
  }else{
    $reading_grade.innerText='D';
  }
  if(grade3>=3){
    $logic_grade.innerText='A';
  }else if(grade3>=2){
    $logic_grade.innerText='B';
  }else if(grade3>=1){
    $logic_grade.innerText='C';
  }else{
    $logic_grade.innerText='D';
  }
  if(grade4>=3){
    $impl_grade.innerText='A';
  }else if(grade4>=2){
    $impl_grade.innerText='B';
  }else if(grade4>=1){
    $impl_grade.innerText='C';
  }else{
    $impl_grade.innerText='D';
  }
  $similarity.innerText='-';

  new Chart(document.getElementById("radar-chart"), {
    type: 'radar',
    data: {
      labels: ["총점", "독해력", "논리력", "표현력", "모범답안 유사도"],
      datasets: [
        {
          label: "평균",
          fill: true,
          backgroundColor: "rgba(179,181,198,0.2)",
          borderColor: "rgba(179,181,198,1)",
          pointBorderColor: "#fff",
          pointBackgroundColor: "rgba(179,181,198,1)",
          data: [1.5, 1.5, 1.5, 1.5, 1.5]
        }, {
          label: "본인",
          fill: true,
          backgroundColor: "rgba(0, 118, 192,0.2)",
          borderColor: "rgba(0, 118, 192,1)",
          pointBorderColor: "#fff",
          pointBackgroundColor: "rgba(0, 118, 192,1)",
          pointBorderColor: "#fff",
          data: [grade1, grade2, grade3, grade4, grade5*0.03]
        }
      ]
    },
    options: {
      title: {
        display: true,
        text: userNickname+'님의 상세 성적표'
      },
      scale: {
        ticks : {
          suggestedMin: 0,
          suggestedMax: 3
        }
      },
    }
  });
  new Chart(document.getElementById("bar-chart"), {
    type: 'line',
    data: {
      labels: ['하','중','상'],
      datasets: [
        {
          label: "명",
          //backgroundColor: ["#3e95cd", "#8e5ea2", "#3cba9f", "#e8c3b9", "#c45850"],
          borderColor: '#0076C0',
          backgroundColor: 'rgba(185, 225, 250,0.5)',
          data: [55, 71, 36],

          drawActiveElementsOnTop : true,
          indexAxis:2,
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: probTitle+' 점수 분포표'
      },
      scale: {
        ticks : {
          suggestedMin: 0,
          suggestedMax: 90
        }
      }
    }
  });


</script>

</html>